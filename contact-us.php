<?php include('header.php') ?>
<section class="innerBanner mb-5">
    <div class="bgShape">
        <img src="img/shape.png" alt="shapeDesign" class="img-fluid">
    </div>
    <div class="container h-100">
        <div class="row h-100 align-items-center justify-content-center">
            <div class="col-md-5">
                <div class="bannerContent text-lg-start text-center">
                    <div class="d-flex align-items-center justify-content-lg-start justify-content-center">
                        <span class="alignline"></span>
                        <h4><a href="./">Home</a></h4>
                        <h4 class="px-2">></h4>
                        <h4>Reach out to us</h4>
                    </div>
                    <h1 data-aos="fade-up">Contact Us</h1>
                    <p data-aos="fade-up">We’d love to hear from you! If you have questions about our products,
                        services, support, staff augmentation or are interested to partner with us,
                        please feel free to reach out to us.</p>
                </div>
            </div>
            <div class="col-md-6 h-100 text-end">
                <div class="sliderImg p-3 h-100">
                    <img src="img/contact-banner.png" alt="banner-img1" class="h-100" data-aos="fade-left"
                        data-aos-duration="3500">
                </div>
            </div>
        </div>
    </div>
</section>
<section class="wapper_address position-relative">
    <div class="bgdots">
        <img src="img/bgDots.png" alt="bgDots" class="img-fluid">
    </div>
    <div class="container">
        <div class="row py-5 justify-content-center">
            <div class="col-lg-3 col-sm-6">
                <div class="c-addr ">
                    <div class="col-md-12">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#f1c144"
                            class="bi bi-telephone" viewBox="0 0 16 16">
                            <path
                                d="M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.6 17.6 0 0 0 4.168 6.608 17.6 17.6 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.68.68 0 0 0-.58-.122l-2.19.547a1.75 1.75 0 0 1-1.657-.459L5.482 8.062a1.75 1.75 0 0 1-.46-1.657l.548-2.19a.68.68 0 0 0-.122-.58zM1.884.511a1.745 1.745 0 0 1 2.612.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.68.68 0 0 0 .178.643l2.457 2.457a.68.68 0 0 0 .644.178l2.189-.547a1.75 1.75 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.6 18.6 0 0 1-7.01-4.42 18.6 18.6 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877z" />
                        </svg>
                    </div>
                    <div class="col-md-12">
                        <h3 class="divider-sm">Call</h3>
                    </div>
                    <div class="col-md-12">
                        <div class="wpb_text_column wpb_content_element ">
                            <div class="wpb_wrapper">
                                <p><a href="tel:+917032295551">+91 - 7032295551</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-sm-6">
                <div class="c-addr">
                    <div class="col-md-12">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#f1c144"
                            class="bi bi-envelope-at" viewBox="0 0 16 16">
                            <path
                                d="M2 2a2 2 0 0 0-2 2v8.01A2 2 0 0 0 2 14h5.5a.5.5 0 0 0 0-1H2a1 1 0 0 1-.966-.741l5.64-3.471L8 9.583l7-4.2V8.5a.5.5 0 0 0 1 0V4a2 2 0 0 0-2-2zm3.708 6.208L1 11.105V5.383zM1 4.217V4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.217l-7 4.2z" />
                            <path
                                d="M14.247 14.269c1.01 0 1.587-.857 1.587-2.025v-.21C15.834 10.43 14.64 9 12.52 9h-.035C10.42 9 9 10.36 9 12.432v.214C9 14.82 10.438 16 12.358 16h.044c.594 0 1.018-.074 1.237-.175v-.73c-.245.11-.673.18-1.18.18h-.044c-1.334 0-2.571-.788-2.571-2.655v-.157c0-1.657 1.058-2.724 2.64-2.724h.04c1.535 0 2.484 1.05 2.484 2.326v.118c0 .975-.324 1.39-.639 1.39-.232 0-.41-.148-.41-.42v-2.19h-.906v.569h-.03c-.084-.298-.368-.63-.954-.63-.778 0-1.259.555-1.259 1.4v.528c0 .892.49 1.434 1.26 1.434.471 0 .896-.227 1.014-.643h.043c.118.42.617.648 1.12.648m-2.453-1.588v-.227c0-.546.227-.791.573-.791.297 0 .572.192.572.708v.367c0 .573-.253.744-.564.744-.354 0-.581-.215-.581-.8Z" />
                        </svg>
                    </div>
                    <div class="col-md-12">
                        <h3 class="divider-sm">Email</h3>
                    </div>
                    <div class="col-md-12">
                        <div class="wpb_text_column wpb_content_element ">
                            <div class="wpb_wrapper">
                                <p style="text-align: center;"><a
                                        href="mailto:Contactus@whitekraaft.com">contactus@whitekraaft.com </a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-sm-6">
                <div class="c-addr">
                    <div class="col-md-12">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#f1c144"
                            class="bi bi-geo-alt" viewBox="0 0 16 16">
                            <path
                                d="M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10" />
                            <path d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6" />
                        </svg>
                    </div>
                    <div class="col-md-12">
                        <h3 class="divider-sm">Address</h3>
                    </div>
                    <div class="col-md-12">
                        <div class="wpb_text_column wpb_content_element ">
                            <div class="wpb_wrapper">
                                <p style="text-align: center;font-size: 13px;">Hyderabad, Telangana – 500081.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- <div class="col-lg-3 col-sm-6">
                <div class="c-addr">
                    <div class="col-md-12">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#f1c144"
                            class="bi bi-alarm" viewBox="0 0 16 16">
                            <path
                                d="M8.5 5.5a.5.5 0 0 0-1 0v3.362l-1.429 2.38a.5.5 0 1 0 .858.515l1.5-2.5A.5.5 0 0 0 8.5 9z" />
                            <path
                                d="M6.5 0a.5.5 0 0 0 0 1H7v1.07a7.001 7.001 0 0 0-3.273 12.474l-.602.602a.5.5 0 0 0 .707.708l.746-.746A6.97 6.97 0 0 0 8 16a6.97 6.97 0 0 0 3.422-.892l.746.746a.5.5 0 0 0 .707-.708l-.601-.602A7.001 7.001 0 0 0 9 2.07V1h.5a.5.5 0 0 0 0-1zm1.038 3.018a6 6 0 0 1 .924 0 6 6 0 1 1-.924 0M0 3.5c0 .753.333 1.429.86 1.887A8.04 8.04 0 0 1 4.387 1.86 2.5 2.5 0 0 0 0 3.5M13.5 1c-.753 0-1.429.333-1.887.86a8.04 8.04 0 0 1 3.527 3.527A2.5 2.5 0 0 0 13.5 1" />
                        </svg>
                    </div>
                    <div class="col-md-12">
                        <h3 class="divider-sm">Working Hours</h3>
                    </div>
                    <div class="col-md-12">
                        <div class="wpb_text_column wpb_content_element ">
                            <div class="wpb_wrapper">
                                <p style="text-align: center;">Monday to Friday</p>
                                <p style="text-align: center;">9:30am to 5:30pm</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->




        </div>
    </div>
</section>
<?php
// Check if form is submitted and file is uploaded
if (isset($_POST['button']) || isset($_FILES['attachment'])) {



    // Load POST data from HTML form
    $sender_name = $_POST["sender_name"]; // Sender's name
    $reply_to_email = $_POST["sender_email"]; // Reply-to email
    $subject = $_POST["subject"]; // Email subject
    $message = $_POST["message"]; // Email body
    $phone = $_POST["sender_mobile"];
    $company = $_POST["sender_Company"];
    $queries = array(1 => "Product / Service Inquiry", 2 => "Technical Support", 3 => "Partnership Opportunities", 4 => "General Questions", 5 => "Other (please specify)");
    $query = $queries[(int) $_POST['queries']];


    // Define sender and recipient emails
    $from_email = $reply_to_email; // Sender email
    $recipient_email = 'nani10576@gmail.com'; // Recipient email


    // Validate sender name (uncomment for validation)
    // if (strlen($sender_name) < 1) {
    //     die('Name is too short or empty!');
    // }

    // Get uploaded file data
    $tmp_name = $_FILES['attachment']['tmp_name']; // Temp file path
    $name = $_FILES['attachment']['name']; // Original file name
    $size = $_FILES['attachment']['size']; // File size
    $type = $_FILES['attachment']['type']; // File type
    $error = $_FILES['attachment']['error']; // Upload error

    // Check for upload errors
    if ($error > 0) {
        die('<h4 class="errorMSg">Upload error or no file uploaded</h4>');
    }

    // Read the file and encode its content
    $handle = fopen($tmp_name, "r"); // Open file for reading
    $content = fread($handle, $size); // Read file content
    fclose($handle); // Close file

    $encoded_content = chunk_split(base64_encode($content)); // Encode content
    $boundary = md5("random"); // Generate a unique boundary

    // Define email headers
    $headers = "MIME-Version: 1.0\r\n"; // Specify MIME version
    // Set sender email
    $headers .= "From: " . $from_email . "\r\n";
    // Set reply-to email
    $headers .= "Reply-To: " . $reply_to_email . "\r\n";
    // Set content type and boundary
    $headers .= "Content-Type: multipart/mixed; boundary=$boundary\r\n";

    // Construct email body with message and attachment
    $body = "--$boundary\r\n";
    $body .= "Content-Type: text/plain; charset=ISO-8859-1\r\n";

    $body .=   $sender_name . "\r\n";
    $body .=   $reply_to_email . "\r\n";
    $body .=   $phone . "\r\n";
    $body .=   $company . "\r\n";
    $body .= $query . "\r\n";
    $body .=   $message . "\r\n";
    $body .= " \r\n";
    //$body .= "//Content-Transfer-Encoding: base64\r\n\r\n";
    // $body .= chunk_split(base64_encode($message)); // Encode message 




    // Add attachment to the email body

    $body .= "--$boundary\r\n";
    $body .= "Content-Type: $type; name=\"$name\"\r\n";
    $body .= "Content-Disposition: attachment; filename=\"$name\"\r\n";
    // $body .= "Content-Transfer-Encoding: base64\r\n";
    $body .= "X-Attachment-Id: " . rand(1000, 99999) . "\r\n\r\n";
    $body .= $encoded_content; // Append encoded file content

    // Send the email
    $sentMailResult = mail($recipient_email, $subject, $body, $headers);

    // Check if the email was sent successfully
    if ($sentMailResult) {
        echo "<h3 class='successMsg'>Thank you for reaching out to us. We will get back to you shortly.</h3>";
        // Optionally delete the file after sending
        // unlink($name);
    } else {
        die("Sorry, the email could not be sent. Please try again.");
    }
}
?>


<section class="contactForm py-5 text-center">
    <div class="col-8 m-auto text-center">
        <div class="col-md-12">
            <div class="secTitle text-center pb-3">
                <!-- <div class="d-flex align-items-center justify-content-center" data-aos="fade-up"
                    data-aos-duration="1000">
                    <span class="alignline"></span>
                    <h6>we Are</h6>
                </div> -->
                <h2 data-aos="fade-up" data-aos-duration="1300">Get in Touch with Us</h2>
                <p data-aos="fade-up" data-aos-duration="1800">Please share your thoughts with us.
                    Let us know if you are facing any issues or have any queries. We will get back to you at the
                    earliest.</p>
            </div>
        </div>
        <form id="contactUs" enctype=" multipart/form-data" action="" class="row" data-aos="fade-up" data-aos-duration="1300">
            <!-- Sender Name -->
            <div class="col-md-6">
                <div class="form-group mb-4 position-relative text-start">
                    <label class="labelHeading">Your Name</label>
                    <input class="form-control" type="text" name="senderName" required>
                    <span class="error-message text-danger"></span>
                </div>
            </div>
            <!-- Sender Email -->
            <div class="col-md-6">
                <div class="form-group mb-4 position-relative text-start">
                    <label class="labelHeading">Email</label>
                    <input class="form-control" type="email" name="senderEmail" required>
                    <span class="error-message text-danger"></span>
                </div>
            </div>
            <!-- Sender Mobile -->
            <div class="col-md-6">
                <div class="form-group mb-4 position-relative text-start">
                    <label class="labelHeading">Phone Number</label>
                    <input class="form-control" type="text" name="senderMobile" required>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                        <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
                    </svg>
                    <span class="tooltip">Phone number should include the country code followed by the number.</span>
                    <span class="error-message text-danger"></span>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group mb-4 position-relative text-start">
                    <label class="labelHeading">Company Name</label>
                    <input class="form-control" type="text" name="senderCompany" required>
                    <span class="error-message text-danger"></span>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group mb-4 position-relative text-start">
                    <label class="labelHeading">Subject</label>
                    <input class="form-control" type="text" name="subject">
                    <span class="error-message text-danger"></span>
                </div>
            </div>

            <!-- Sender Query -->
            <div class="col-lg-6 col-md-6">
                <div class="form-outline mb-4 position-relative text-start">
                    <select class="form-select" name="queries">
                        <option value="1" selected>Product / Service Inquiry</option>
                        <option value="2">Technical Support</option>
                        <option value="3">Partnership Opportunities</option>
                        <option value="4">General Questions</option>
                        <option value="5">Other (please specify)</option>
                    </select>
                    <span class="error-message text-danger"></span>
                </div>
            </div>
            <!-- Message -->
            <div class="col-md-12">
                <div class="form-group mb-4 position-relative text-start">
                    <label class="labelHeading">Message</label>
                    <textarea class="form-control pt-3" name="message" rows="5" maxlength="500"></textarea>
                    <span class="character-limit text-muted">Maximum 500 characters allowed.</span>
                    <span class="error-message text-danger"></span>
                </div>
            </div>
            <!-- File Upload -->
            <div class="col-md-6">
                <div class="form-group mb-3 position-relative text-start">
                    <div class="uploadBtn position-relative">Upload
                        <input id="WKattachement" class="form-control" type="file" name="attachment" accept=".pdf,.doc,.docx">
                    </div>
                    <span class="file-info text-muted">Allowed file types: .pdf, .doc, .docx. Max size: 5MB.</span>
                    <span class="error-message text-danger"></span>
                    <div class="progress mt-2 d-none">
                        <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
            </div>
            <!-- Submit Button -->
            <div class="col-md-12 d-flex align-items-center">
                <div class="bTn d-flex align-items-center mb-3 position-relative">
                    <span class="alignline"></span>
                    <button type="button" name="button" value="Submit" onclick="submitContactForm()">Submit</button>
                </div>
            </div>
        </form>


        <script>
            const submitContactForm = () => {
                const form = document.getElementById("contactUs");
                const fields = form.querySelectorAll("[name]");
                let isValid = true;

                fields.forEach(field => {
                    const errorMessage = field.parentElement.querySelector(".error-message");

                    // Clear previous error
                    if (errorMessage) errorMessage.textContent = "";

                    // Skip optional fields (e.g., attachment)
                    if (field.name === "attachment") return;

                    // Check for empty mandatory fields
                    if (!field.value.trim() && ["senderName", "senderEmail", "senderMobile", 'senderCompany', 'subject'].includes(field.name)) {
                        if (errorMessage) errorMessage.textContent = `${field.previousElementSibling.textContent} is required.`;
                        isValid = false;
                        return;
                    }

                    // Validate senderName (letters only)
                    if (field.name === "senderName") {
                        const nameRegex = /^[A-Za-z\s]+$/;
                        if (!nameRegex.test(field.value)) {
                            errorMessage.textContent = "Name should contain only letters.";
                            isValid = false;
                        }
                    }

                    // Validate senderEmail (valid email format)
                    if (field.name === "senderEmail") {
                        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                        if (!emailRegex.test(field.value)) {
                            errorMessage.textContent = "Please enter a valid email address.";
                            isValid = false;
                        }
                    }

                    // Validate senderMobile (numbers only)
                    if (field.name === "senderMobile") {
                        const mobileRegex = /^[0-9]+$/;
                        if (!mobileRegex.test(field.value)) {
                            errorMessage.textContent = "Phone number should contain only numbers.";
                            isValid = false;
                        }
                    }
                });

                if (isValid) {
                    alert("Form submitted successfully!");
                    form.submit(); // Proceed with form submission
                }
            };

            // Clear error message on input change
            document.querySelectorAll("[name]").forEach(field => {
                field.addEventListener("input", () => {
                    const errorMessage = field.parentElement.querySelector(".error-message");
                    if (errorMessage) {
                        errorMessage.textContent = ""; // Clear error message
                    }
                });
            });

            // Restrict live input for mobile field (numbers only)
            document.querySelector("[name='senderMobile']").addEventListener("input", function() {
                this.value = this.value.replace(/[^0-9]/g, ""); // Remove invalid characters
            });

            // Handle file upload with progress bar
            document.getElementById('WKattachement').addEventListener("change", function(e) {
                const file = e.target.files[0];
                const progressContainer = e.target.parentElement.parentElement.children[3]
                const progressBar = e.target.parentElement.parentElement.children[3].children[0]


                if (file) {
                    progressContainer.classList.remove("d-none");
                    const maxSize = 5 * 1024 * 1024; // 5MB

                    if (file.size > maxSize) {
                        alert("File size exceeds 5MB.");
                        e.target.value = ""; // Clear the file input
                        progressContainer.classList.add("d-none");
                        return;
                    }

                    // Simulate upload progress
                    let progress = 0;
                    const interval = setInterval(() => {
                        progress += 10;
                        progressBar.style.width = progress + "%";
                        progressBar.setAttribute("aria-valuenow", progress);
                        if (progress >= 100) {
                            clearInterval(interval);
                            alert("File uploaded successfully!");
                            progressContainer.classList.add("d-none");
                        }
                    }, 100); // Simulates upload progress every 100ms
                }
            });
        </script>

    </div>
</section>
<?php include('footer.php') ?>